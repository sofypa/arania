<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ara√±a Seda de Oro - Visualizador 3D</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

<style>
  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    touch-action: none;
  }

  #ui {
    position: fixed;
    top: 10px;
    left: 10px;
    right: 10px;
    z-index: 999;
    max-width: 400px;
  }

  button {
    padding: 10px 14px;
    margin-right: 5px;
    margin-bottom: 5px;
    cursor: pointer;
    background: white;
    border: 2px solid #333;
    border-radius: 4px;
    font-size: 14px;
    touch-action: manipulation;
  }

  button:hover {
    background: #f0f0f0;
  }

  button.active {
    background: #4CAF50;
    color: white;
  }

  #panel {
    margin-top: 10px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 15px;
    border-radius: 8px;
    max-height: 70vh;
    overflow-y: auto;
  }

  #panel h3 {
    margin-top: 0;
    color: #4CAF50;
    font-size: 18px;
  }

  #instrucciones {
    margin-top: 10px;
    font-size: 11px;
    color: #ccc;
    line-height: 1.4;
  }

  .info-buttons {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
  }

  .info-buttons button {
    flex: 1 1 calc(50% - 5px);
    font-size: 12px;
    padding: 8px 10px;
    margin: 0;
  }

  #infoContent {
    margin-top: 10px;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 5px;
    font-size: 14px;
    line-height: 1.5;
    max-height: 250px;
    overflow-y: auto;
  }

  #infoContent h4 {
    margin: 0 0 8px 0;
    color: #FFD700;
    font-size: 15px;
  }

  #infoContent::-webkit-scrollbar {
    width: 8px;
  }

  #infoContent::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.3);
    border-radius: 4px;
  }

  #infoContent::-webkit-scrollbar-thumb {
    background: #4CAF50;
    border-radius: 4px;
  }

  #panel::-webkit-scrollbar {
    width: 8px;
  }

  #panel::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.3);
    border-radius: 4px;
  }

  #panel::-webkit-scrollbar-thumb {
    background: #4CAF50;
    border-radius: 4px;
  }

  #animalTitle {
    background: rgba(76, 175, 80, 0.9);
    color: white;
    padding: 8px;
    border-radius: 4px;
    margin-bottom: 5px;
    text-align: center;
    font-weight: bold;
    font-size: 14px;
  }

  /* Estilos responsivos para m√≥viles */
  @media (max-width: 768px) {
    #ui {
      max-width: calc(100% - 20px);
    }

    button {
      font-size: 13px;
      padding: 9px 12px;
    }

    #panel h3 {
      font-size: 16px;
    }

    #infoContent {
      font-size: 13px;
      max-height: 200px;
    }

    .info-buttons button {
      font-size: 11px;
      padding: 7px 8px;
    }

    #instrucciones {
      font-size: 10px;
    }
  }
</style>

</head>

<body>

<a-scene cursor="rayOrigin: mouse">

  <!-- Fondo -->
  <a-assets>
    <img id="hdr" src="fondoblur.jpg">
  </a-assets>
  <a-sky src="#hdr"></a-sky>

  <!-- Luces -->
  <a-light type="ambient" intensity="0.6"></a-light>
  <a-light type="directional" intensity="1" position="2 4 2"></a-light>

  <!-- Modelo de la Ara√±a (FIJO) -->
  <a-entity
    id="modelo"
    gltf-model="models/arana.glb"
    position="0 0 0"
    scale="5 5 5"
    rotation="0 180 0">
  </a-entity>

  <!-- Modelo (SUELO) -->
  <a-entity
    gltf-model="models/ground.glb"
    position="0 -1.8 0"
    scale="3 3 3"
    rotation="0 0 0">
  </a-entity>

  <!-- RIG DE C√ÅMARA -->
  <a-entity id="cameraRig" rotation="0 0 0">
    <a-camera
      position="0 0.5 4"
      look-at="#modelo"
      look-controls="enabled: false"
      wasd-controls="enabled: true">
    </a-camera>
  </a-entity>

</a-scene>

<script>
  // Control de rotaci√≥n con mouse y touch
  window.addEventListener('DOMContentLoaded', () => {
    const rig = document.querySelector('#cameraRig');

    if (!rig) {
      console.error('cameraRig no encontrado');
      return;
    }

    let dragging = false;
    let lastX = 0;
    let rotationY = 0;

    // Eventos de mouse
    window.addEventListener('mousedown', e => {
      if (e.target.closest('#ui')) return; // Ignorar clics en UI
      dragging = true;
      lastX = e.clientX;
    });

    window.addEventListener('mouseup', () => dragging = false);

    window.addEventListener('mousemove', e => {
      if (!dragging) return;

      const delta = e.clientX - lastX;
      lastX = e.clientX;

      rotationY += delta * 0.3;
      rig.setAttribute('rotation', `0 ${rotationY} 0`);
    });

    // Eventos t√°ctiles para m√≥viles
    window.addEventListener('touchstart', e => {
      if (e.target.closest('#ui')) return; // Ignorar toques en UI
      dragging = true;
      lastX = e.touches[0].clientX;
    }, { passive: true });

    window.addEventListener('touchend', () => dragging = false);

    window.addEventListener('touchmove', e => {
      if (!dragging) return;
      
      const delta = e.touches[0].clientX - lastX;
      lastX = e.touches[0].clientX;

      rotationY += delta * 0.3;
      rig.setAttribute('rotation', `0 ${rotationY} 0`);
    }, { passive: true });
  });
</script>

<script>
  // Control de zoom con rueda del mouse y pinch en m√≥viles
  window.addEventListener('DOMContentLoaded', () => {
    const camera = document.querySelector('a-camera');
    let zoom = 4;
    const cameraY = 0.5;

    // Zoom con rueda del mouse
    window.addEventListener('wheel', e => {
      if (e.target.closest('#ui')) return; // Ignorar scroll en UI
      zoom += e.deltaY * 0.01;
      zoom = Math.min(Math.max(zoom, 2), 12);

      camera.setAttribute('position', `0 ${cameraY} ${zoom}`);
    });

    // Zoom con pinch en m√≥viles
    let lastDistance = 0;
    
    window.addEventListener('touchstart', e => {
      if (e.touches.length === 2) {
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        lastDistance = Math.hypot(
          touch2.clientX - touch1.clientX,
          touch2.clientY - touch1.clientY
        );
      }
    }, { passive: true });

    window.addEventListener('touchmove', e => {
      if (e.touches.length === 2) {
        e.preventDefault();
        const touch1 = e.touches[0];
        const touch2 = e.touches[1];
        const distance = Math.hypot(
          touch2.clientX - touch1.clientX,
          touch2.clientY - touch1.clientY
        );

        const delta = lastDistance - distance;
        zoom += delta * 0.01;
        zoom = Math.min(Math.max(zoom, 2), 12);

        camera.setAttribute('position', `0 ${cameraY} ${zoom}`);
        lastDistance = distance;
      }
    }, { passive: false });
  });
</script>

<script>
  // Informaci√≥n de la Ara√±a Seda de Oro
  const animal = {
    nombre: "Ara√±a Seda de Oro",
    descripcion: "Es una ara√±a inofensiva conocida por producir una de las sedas biol√≥gicas m√°s resistentes del mundo. Su hilo tiene un brillo dorado bajo el sol, cualidad que se aprovecha en lugares como Indonesia para confeccionar textiles.",
    habitat:  "Se encuentra desde Estados Unidos hasta Argentina. Se pueden encontrar en ambientes tropicales, donde la temperatura y humedad son altas, tejen la telara√±a. Es com√∫n encontrarlas entre los espacios de los √°rboles y en postes de luz.",
    alimentacion: "Se alimenta de saltamontes, escarabajos, moscas y otros peque√±os insectos voladores como lib√©lulas. Esto es muy beneficioso para los seres humanos, porque ayuda a controlar plagas.",
    conservacion: "No est√° en riesgo de extinci√≥n; se considera de "Preocupaci√≥n Menor (Least Concern)" por la UICN, debido a su com√∫n h√°bitat en Am√©rica y porque se adapta bien a parques y jardines."
  };

  let infoActiva = null;

  // Funci√≥n para mostrar informaci√≥n del animal
  function mostrarAnimal() {
    document.getElementById('titulo').textContent = animal.nombre;
    document.getElementById('descripcion').textContent = animal.descripcion;
    
    // Si hab√≠a info adicional visible, actualizarla
    if (infoActiva) {
      mostrarInfo(infoActiva);
    } else {
      document.getElementById('infoContent').style.display = 'none';
    }
  }

  // Funci√≥n para mostrar informaci√≥n adicional
  function mostrarInfo(tipo) {
    const infoContent = document.getElementById('infoContent');
    
    let titulo = '';
    let contenido = '';
    
    if (infoActiva === tipo) {
      // Si se clickea el mismo bot√≥n, ocultar
      infoActiva = null;
      infoContent.style.display = 'none';
      actualizarBotonesInfo();
      return;
    }
    
    switch(tipo) {
      case 'habitat':
        titulo = 'üåç H√°bitat';
        contenido = animal.habitat;
        break;
      case 'alimentacion':
        titulo = 'üçÉ Alimentaci√≥n';
        contenido = animal.alimentacion;
        break;
      case 'conservacion':
        titulo = 'üõ°Ô∏è Estado de Conservaci√≥n';
        contenido = animal.conservacion;
        break;
    }
    
    infoContent.innerHTML = `<h4>${titulo}</h4><p>${contenido}</p>`;
    infoContent.style.display = 'block';
    infoActiva = tipo;
    actualizarBotonesInfo();
  }

  // Actualizar botones de informaci√≥n
  function actualizarBotonesInfo() {
    const botonesInfo = document.querySelectorAll('.info-buttons button');
    botonesInfo.forEach(btn => {
      const tipo = btn.getAttribute('data-info');
      if (tipo === infoActiva) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    });
  }

  // Funci√≥n para mostrar/ocultar panel
  function togglePanel() {
    const panel = document.getElementById('panel');
    if (panel.style.display === 'none') {
      panel.style.display = 'block';
    } else {
      panel.style.display = 'none';
    }
  }

  // Inicializar informaci√≥n al cargar la p√°gina
  document.addEventListener('DOMContentLoaded', () => {
    mostrarAnimal();
  });
</script>

<div id="ui">
  <div id="animalTitle">üï∑Ô∏è Ara√±a Seda de Oro</div>

  <button onclick="togglePanel()">‚ÑπÔ∏è Informaci√≥n</button>

  <div id="panel" style="display: none;">
    <h3 id="titulo"></h3>
    <p id="descripcion"></p>
    
    <div class="info-buttons">
      <button data-info="habitat" onclick="mostrarInfo('habitat')">üåç H√°bitat</button>
      <button data-info="alimentacion" onclick="mostrarInfo('alimentacion')">üçÉ Alimentaci√≥n</button>
      <button data-info="conservacion" onclick="mostrarInfo('conservacion')">üõ°Ô∏è Conservaci√≥n</button>
    </div>
    
    <div id="infoContent" style="display: none;"></div>
    
    <div id="instrucciones">
      <strong>PC:</strong> WASD: Mover | Arrastrar: Rotar | Rueda: Zoom<br>
      <strong>M√≥vil:</strong> Deslizar: Rotar | Pinch: Zoom
    </div>
  </div>
</div>

</body>
</html>